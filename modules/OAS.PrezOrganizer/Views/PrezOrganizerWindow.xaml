<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="OpenAsphalte.Modules.PrezOrganizer.Views.PrezOrganizerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Organiseur de prÃ©sentations"
        MinHeight="520" MinWidth="620"
        Background="#F0F0F0"
        ResizeMode="CanResize">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/OAS.Core;component/Resources/OasStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Style bouton toolbar compact -->
            <Style x:Key="ToolbarButton" TargetType="Button">
                <Setter Property="Width" Value="36"/>
                <Setter Property="Height" Value="36"/>
                <Setter Property="Margin" Value="0,2"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="#CCC"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4"
                                    SnapsToDevicePixels="True">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#E8F5E9"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#4CAF50"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#C8E6C9"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="Foreground" Value="#BBB"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- SÃ©parateur toolbar -->
            <Style x:Key="ToolbarSeparator" TargetType="Separator">
                <Setter Property="Height" Value="1"/>
                <Setter Property="Margin" Value="4,6"/>
                <Setter Property="Background" Value="#DDD"/>
            </Style>

            <!-- Style ListBox item avec indicateurs -->
            <Style x:Key="LayoutListBoxItem" TargetType="ListBoxItem">
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="FontSize" Value="13"/>
                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                <Setter Property="BorderBrush" Value="#F0F0F0"/>
                <Setter Property="AllowDrop" Value="True"/>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="#E8F5E9"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Titre -->
            <RowDefinition Height="Auto"/>   <!-- Barre d'outils -->
            <RowDefinition Height="*"/>      <!-- Zone principale -->
            <RowDefinition Height="Auto"/>   <!-- Barre de statut -->
            <RowDefinition Height="Auto"/>   <!-- Boutons -->
        </Grid.RowDefinitions>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- TITRE -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <TextBlock Grid.Row="0"
                   x:Name="WindowHeader"
                   Text="Organiseur de prÃ©sentations"
                   Style="{StaticResource OasWindowTitle}"/>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- BARRE D'OUTILS : Recherche -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="1" Background="White" CornerRadius="4" Padding="10" Margin="0,0,0,12">
            <!-- Champ de recherche/filtre -->
            <TextBox x:Name="SearchBox"
                     Padding="8,6"
                     FontSize="13"
                     BorderThickness="1"
                     BorderBrush="#CCC"
                     TextChanged="SearchBox_TextChanged">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Style.Triggers>
                            <Trigger Property="Text" Value="">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                            <VisualBrush.Visual>
                                                <TextBlock x:Name="SearchPlaceholder"
                                                           Text="  Filtrer les prÃ©sentations..."
                                                           Foreground="#999" FontSize="13" Margin="4,0,0,0"/>
                                            </VisualBrush.Visual>
                                        </VisualBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Style>
            </TextBox>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ZONE PRINCIPALE : Liste + Toolbar + DÃ©tails -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>    <!-- Liste des prÃ©sentations -->
                <ColumnDefinition Width="Auto"/>  <!-- Barre de boutons -->
                <ColumnDefinition Width="2*"/>    <!-- DÃ©tails / RÃ©sumÃ© -->
            </Grid.ColumnDefinitions>

            <!-- LISTE DES PRÃ‰SENTATIONS -->
            <Border Grid.Column="0" Background="White" CornerRadius="4" Margin="0,0,8,0">
                <ListBox x:Name="LayoutListBox"
                         BorderThickness="0"
                         SelectionMode="Extended"
                         ItemContainerStyle="{StaticResource LayoutListBoxItem}"
                         SelectionChanged="LayoutListBox_SelectionChanged"
                         MouseDoubleClick="LayoutListBox_MouseDoubleClick"
                         PreviewMouseLeftButtonDown="LayoutListBox_PreviewMouseLeftButtonDown"
                         PreviewMouseMove="LayoutListBox_PreviewMouseMove"
                         Drop="LayoutListBox_Drop"
                         DragOver="LayoutListBox_DragOver"
                         AllowDrop="True"/>
            </Border>

            <!-- BARRE DE BOUTONS VERTICALE (avec scroll si trop de boutons) -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="4,0">
            <StackPanel VerticalAlignment="Center">

                <!-- DÃ©placement -->
                <Button x:Name="BtnMoveTop" Style="{StaticResource ToolbarButton}"
                        Content="â«" Click="BtnMoveTop_Click"/>
                <Button x:Name="BtnMoveUp" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ”¼" Click="BtnMoveUp_Click"/>
                <Button x:Name="BtnMoveDown" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ”½" Click="BtnMoveDown_Click"/>
                <Button x:Name="BtnMoveBottom" Style="{StaticResource ToolbarButton}"
                        Content="â¬" Click="BtnMoveBottom_Click"/>

                <Separator Style="{StaticResource ToolbarSeparator}"/>

                <!-- Tri et inversion -->
                <Button x:Name="BtnReverse" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ”ƒ" Click="BtnReverse_Click"/>
                <Button x:Name="BtnSort" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ”¤" Click="BtnSort_Click">
                    <Button.ContextMenu>
                        <ContextMenu x:Name="SortContextMenu">
                            <MenuItem x:Name="SortAlphaAsc" Header="AlphabÃ©tique (Aâ†’Z)" Click="SortAlphaAsc_Click"/>
                            <MenuItem x:Name="SortAlphaDesc" Header="AlphabÃ©tique (Zâ†’A)" Click="SortAlphaDesc_Click"/>
                            <Separator/>
                            <MenuItem x:Name="SortNumAsc" Header="NumÃ©rique (1â†’9)" Click="SortNumAsc_Click"/>
                            <MenuItem x:Name="SortNumDesc" Header="NumÃ©rique (9â†’1)" Click="SortNumDesc_Click"/>
                            <Separator/>
                            <MenuItem x:Name="SortArchAsc" Header="Architectural" Click="SortArchAsc_Click"/>
                            <MenuItem x:Name="SortArchDesc" Header="Architectural (inverse)" Click="SortArchDesc_Click"/>
                        </ContextMenu>
                    </Button.ContextMenu>
                </Button>

                <Separator Style="{StaticResource ToolbarSeparator}"/>

                <!-- Ã‰dition -->
                <Button x:Name="BtnRename" Style="{StaticResource ToolbarButton}"
                        Content="âœï¸" Click="BtnRename_Click"/>
                <Button x:Name="BtnCopy" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ“‹" Click="BtnCopy_Click"/>
                <Button x:Name="BtnAdd" Style="{StaticResource ToolbarButton}"
                        Content="âž•" Click="BtnAdd_Click"/>
                <Button x:Name="BtnDelete" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ—‘ï¸" Click="BtnDelete_Click"/>

                <Separator Style="{StaticResource ToolbarSeparator}"/>

                <!-- Transformations -->
                <Button x:Name="BtnFindReplace" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ”" Click="BtnFindReplace_Click"/>
                <Button x:Name="BtnRenameTool" Style="{StaticResource ToolbarButton}"
                        Content="ðŸ·ï¸" Click="BtnRenameTool_Click"/>
                <Button x:Name="BtnCase" Style="{StaticResource ToolbarButton}"
                        Content="Aa" FontSize="12" FontWeight="Bold" Click="BtnCase_Click">
                    <Button.ContextMenu>
                        <ContextMenu x:Name="CaseContextMenu">
                            <MenuItem x:Name="CaseUpper" Header="MAJUSCULES" Click="CaseUpper_Click"/>
                            <MenuItem x:Name="CaseLower" Header="minuscules" Click="CaseLower_Click"/>
                            <MenuItem x:Name="CaseTitle" Header="PremiÃ¨re Lettre Majuscule" Click="CaseTitle_Click"/>
                        </ContextMenu>
                    </Button.ContextMenu>
                </Button>
            </StackPanel>
            </ScrollViewer>

            <!-- PANNEAU DE DÃ‰TAILS / RÃ‰SUMÃ‰ -->
            <Border Grid.Column="2" Background="White" CornerRadius="4" Padding="12" Margin="8,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- DÃ©tails de l'item sÃ©lectionnÃ© -->
                        <StackPanel x:Name="DetailPanel" Visibility="Collapsed">
                            <TextBlock x:Name="DetailHeader" Text="DÃ©tails" Style="{StaticResource OasGroupHeader}"/>

                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" x:Name="OriginalNameLabel"
                                           Text="Nom original :" Style="{StaticResource OasInfoLabel}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="OriginalNameValue"
                                           Style="{StaticResource OasInfoValue}" FontFamily="Consolas"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" x:Name="NewNameLabel"
                                           Text="Nouveau nom :" Style="{StaticResource OasInfoLabel}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="NewNameValue"
                                           Style="{StaticResource OasInfoValue}" FontFamily="Consolas" Foreground="#2E7D32" FontWeight="SemiBold"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" x:Name="StatusLabel"
                                           Text="Statut :" Style="{StaticResource OasInfoLabel}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="StatusValue"
                                           Style="{StaticResource OasInfoValue}"/>
                            </Grid>
                        </StackPanel>

                        <!-- RÃ©sumÃ© des modifications (rÃ©ductible) -->
                        <Expander x:Name="SummaryExpander" IsExpanded="True" Margin="0,16,0,0">
                            <Expander.Header>
                                <TextBlock x:Name="PendingHeader" Text="Modifications en attente" Style="{StaticResource OasGroupHeader}"/>
                            </Expander.Header>
                            <StackPanel x:Name="SummaryPanel" Margin="0,4,0,0">
                                <TextBlock x:Name="RenameCount" Style="{StaticResource OasInfoValue}" Margin="0,4,0,0"/>
                                <TextBlock x:Name="MoveCount" Style="{StaticResource OasInfoValue}" Margin="0,2,0,0"/>
                                <TextBlock x:Name="AddCount" Style="{StaticResource OasInfoValue}" Margin="0,2,0,0"/>
                                <TextBlock x:Name="DeleteCount" Style="{StaticResource OasInfoValue}" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- BARRE DE STATUT -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Row="3" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" x:Name="StatusBarText" Text="0 prÃ©sentation(s)"
                       Foreground="#666" VerticalAlignment="Center" FontSize="12"/>
            <TextBlock Grid.Column="1" x:Name="PendingBarText" Text=""
                       Foreground="#FF9800" VerticalAlignment="Center" FontSize="12" Margin="0,0,16,0"/>
            <Button Grid.Column="2" x:Name="BtnSetCurrent"
                    Content="Activer" Style="{StaticResource OasSecondaryButton}"
                    Padding="12,6" FontSize="12"
                    Click="BtnSetCurrent_Click"/>
        </Grid>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- BOUTONS PRINCIPAUX -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="4" Margin="0,12,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>  <!-- Undo -->
                    <ColumnDefinition Width="Auto"/>  <!-- Reset -->
                    <ColumnDefinition Width="*"/>     <!-- Spacer -->
                    <ColumnDefinition Width="Auto"/>  <!-- Fermer -->
                    <ColumnDefinition Width="Auto"/>  <!-- Appliquer -->
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0" x:Name="BtnUndo"
                        Content="â†© Annuler" Style="{StaticResource OasWarningButton}"
                        Padding="14,10" Margin="0,0,8,0"
                        IsEnabled="False"
                        Click="BtnUndo_Click"/>

                <Button Grid.Column="1" x:Name="BtnReset"
                        Content="RÃ©initialiser" Style="{StaticResource OasWarningButton}"
                        Padding="14,10"
                        Click="BtnReset_Click"/>

                <Button Grid.Column="3" x:Name="BtnClose"
                        Content="Fermer" Style="{StaticResource OasSecondaryButton}"
                        Margin="0,0,10,0"
                        Click="BtnClose_Click"/>

                <Button Grid.Column="4" x:Name="BtnApply"
                        Content="Appliquer" Style="{StaticResource OasPrimaryButton}"
                        IsEnabled="False"
                        Click="BtnApply_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>
